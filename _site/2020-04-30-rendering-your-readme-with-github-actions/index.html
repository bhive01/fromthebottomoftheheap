  <!DOCTYPE html>
<html lang="en">
  <head prefix="dc: http://purl.org/dc/terms/ og: http://ogp.me/ns# :cc http://creativecommons.org/ns#">
    <meta charset="utf-8">
    <title>Rendering your README with GitHub Actions</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Gavin Simpson">
    
    
<!-- HTML5 metadata -->

<meta name="keywords" content="GitHub, GitHub Actions, Continuous Integration, R package, workflow" />


<meta name="description" content="Rendering your README with GitHub Actions" />

<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="Rendering your README with GitHub Actions" />
<meta property="dc:creator" content="Gavin Simpson" />
<meta property="dc:date" content="2020-04-30T09:00:00-06:00" />
<meta property="dc:type" content="" /> <!-- article? entry?-->
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:source" content="From the Bottom of the Heap" />
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="Rendering your README with GitHub Actions" />
<meta property="og:author" content="https://www.fromthebottomoftheheap.net/about/" />
<meta property="http://ogp.me/ns/profile#first_name" content="Gavin"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Simpson"/>
<meta property="http://ogp.me/ns/article#published_time" content="2020-04-30T09:00:00-06:00" />
<meta property="og:site_name" content="From the Bottom of the Heap" />
<meta property="og:url" content="https://www.fromthebottomoftheheap.net/2020-04-30-rendering-your-readme-with-github-actions/" />
<meta property="og:type" content="article" />

<meta name="og:description" content="Rendering your README with GitHub Actions" />

<!-- Twitter Card Meta data -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site.id" content="@ucfagls" />
<meta name="twitter:creator:id" content="@ucfagls" />
<meta name="twitter:title" content="Rendering your README with GitHub Actions" />


<!-- Google Scholar Metadata -->
<meta name="resource_type" content="From the Bottom of the Heap"/>
<meta name="citation_journal_title" content="From the Bottom of the Heap"/>
<meta name="citation_publication_date" content="30 Apr 2020"/>
<meta name="citation_date" content="30 Apr 2020"/>
<meta name="citation_author" content="Gavin Simpson"/>
<meta name="citation_title" content="Rendering your README with GitHub Actions"/>

    
    <!-- Link to the Atom feeds -->
    <link href="https://www.fromthebottomoftheheap.net/feed.xml" type="application/atom+xml" rel="alternate" title="From the bottom of the heap ATOM feed">
    <link href="https://www.fromthebottomoftheheap.net/feed-R.xml" type="application/atom+xml" rel="alternate" title="From the bottom of the heap ATOM feed of R posts">
    
    <!-- Le styles -->
    <link href="https://www.fromthebottomoftheheap.net/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
    </style>
    <link href="https://www.fromthebottomoftheheap.net/assets/css/pyg_monokai.css" rel="stylesheet">
    <link href="https://www.fromthebottomoftheheap.net/assets/css/ftboth.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="https://www.fromthebottomoftheheap.net/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.fromthebottomoftheheap.net/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.fromthebottomoftheheap.net/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.fromthebottomoftheheap.net/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="https://www.fromthebottomoftheheap.net/assets/ico/apple-touch-icon-57-precomposed.png">
  </head>

  <body>

      <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="https://www.fromthebottomoftheheap.net">From the bottom of the heap</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <li ><a href="https://www.fromthebottomoftheheap.net"><i class="icon-home"></i> Home</a></li>
              <li ><a href="https://www.fromthebottomoftheheap.net/about/"><i class="icon-info-sign"></i> About</a></li>
              <li class="active"><a href="https://www.fromthebottomoftheheap.net/blog/"><i class="icon-comment"></i> Blog</a></li>
              <li ><a href="https://www.fromthebottomoftheheap.net/publications/"><i class="icon-file"></i> Publications</a></li>
              <li ><a href="https://www.fromthebottomoftheheap.net/research/"><i class="icon-wrench"></i> Research</a></li>
              <li  class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="icon-filter"></i> The Lab <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                  <li><a tabindex="-1" href="https://www.fromthebottomoftheheap.net/lab/">About</a></li>
                  <li><a tabindex="-1" href="https://www.fromthebottomoftheheap.net/lab/research/">Research</a></li>
                  <li><a tabindex="-1" href="https://www.fromthebottomoftheheap.net/lab/members/">Members</a></li>
                  <li><a tabindex="-1" href="https://www.fromthebottomoftheheap.net/lab/publications">Publications</a></li>
                  <li><a tabindex="-1" href="https://www.fromthebottomoftheheap.net/lab/join/">Join the lab</a></li>
                </ul>
              </li>
              <li ><a href="https://www.fromthebottomoftheheap.net/teaching/"><i class="icon-user"></i> Teaching</a></li>
              <li  class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-hdd"></i> Code <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="dropdown-submenu">
                    <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/dper-scripts/">DPER Scripts</a>
                    <ul class="dropdown-menu">
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/dper-scripts/chapter-9-statistical-learning/">Chapter 9</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/dper-scripts/chapter-15-analogue-methods/">Chapter 15</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/dper-scripts/chapter-19-human-impacts/">Chapter 19</a>
                      </li>
                    </ul>
                  </li>
                  <li class="dropdown-submenu">
                    <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages">R Packages</a>
                    <ul class="dropdown-menu">
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/analogue/">analogue</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/permute/">permute</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/vegan/">vegan</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/gratia/">gratia</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/cocorresp/">cocorresp</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/coenocliner/">coenocliner</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/temporalEF/">temporalEF</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/canadaHCD/">canadaHCD</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/ggvegan/">ggvegan</a>
                      </li>
                      <li>
                        <a tabindex="-1" href="https://www.fromthebottomoftheheap.net/code/r-packages/pcurve/">pcurve</a>
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>


    <div class="container">
          

      <article>
      <div class="row">
        <!-- <div class="span8 offset2"> -->
        <div class="span10">
          <div class="clearfix">
            
            
          </div>
          <div class="page-header">
            <header>
              <h1>Rendering your README with GitHub Actions </h1>
            </header>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="span12">
          <div class="row">
            <div class="span10">
              
            <p>One of the things that has bugged me for a while about developing R packages that use many of the nice, modern tools we have for tracking our code, producing web sites from the documentation, etc, is that for every code commit I make to the master branch of a package repo, there’s often two or more steps I need to take to keep the package <code>README.md</code> and <em>pkgdown</em> site in sync with the code. Don’t get me wrong; it’s amazing that we have these tools available to help users get to grips with our R packages. It’s just that there’s a lot of extra things to remember to do to keep everything up to date. So the development of free-to-use services such as Travis CI or Appveyor have been very useful as they can automate many of these repetitive tasks. A more recent newcomer to the field are GitHub Actions. The other day I was grappling with getting a GitHub Actions workflow to render a <code>README.Rmd</code> file to <code>README.md</code> on GitHub, so I didn’t have to do it locally all the time. After a lot of trial and error, this is how I got it working.</p>
<p>The general use case I am imagining here is a package author that has a <code>README.Rmd</code> file that contains R code chunks that they want to render to <code>README.md</code>, which will get rendered nicely on github. You might want to do this to provide a simple overview of how to use some key functionality of your package or include a plot or two that can be generated by the package. It’s pretty easy to render this locally with a Makefile or simply invoking the correct R incantation directly in the terminal. But it’d be great if we could automate this.</p>
<p>The first step in getting this working was to recognise that the R Infrastructure organisation has been working to make R-related GitHub Actions workflows available to users. This effort has been lead by Jim Hester and Jim has very helpfully provided a workflow example YAML file showing how one might go about rendering a <code>README.Rmd</code> file to <code>README.md</code> uising the <strong>rmarkdown</strong> package.</p>
<p>Also, the <strong>usethis</strong> package has made it super easy to get started using GitHub Actions; <strong>usethis</strong> provides <code>use_github_actions()</code> to set your package up to start using GitHub Actions. There’s also a <code>use_github-action()</code> function that can add workflows from the <code>r-lib/actions</code> repo to your package.</p>
<p>If you don’t have <strong>usethis</strong> installed, install it (<code>install.packages("usethis")</code>), then you can set your R package repo up to run <code>R CMD check</code> on your package on GitHub’s servers by running</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">usethis<span class="op">::</span><span class="kw">use_github_actions</span>()</a></code></pre></div>
<p>in an R session in the package root folder. Running this will procude something like this</p>
<pre><code>&gt; usethis::use_github_actions()
✔ Setting active project to &#39;/home/gavin/work/git/cocorresp/cocorresp&#39;
✔ Creating &#39;.github/&#39;
✔ Adding &#39;*.html&#39; to &#39;.github/.gitignore&#39;
✔ Creating &#39;.github/workflows/&#39;
✔ Writing &#39;.github/workflows/R-CMD-check.yaml&#39;
● Copy and paste the following lines into &#39;/home/gavin/work/git/cocorresp/cocorresp/README.md&#39;:
  &lt;!-- badges: start --&gt;
  [![R build status](https://github.com/gavinsimpson/cocorresp/workflows/R-CMD-check/badge.svg)](https://github.com/gavinsimpson/cocorresp/actions)
  &lt;!-- badges: end --&gt;</code></pre>
<p>which outlines the steps <strong>usethis</strong> has taken on your behalf. The last line prints out some text that you can paste into the <code>README</code> to show a status badge for the GitHub Action; in this case it will show whether running <code>R CMD check</code> on the server completed without error or not.</p>
<p>This nicely illustrates how you might set things up by hand of course, especially if you don’t want to run <code>R CMD check</code> on each push.</p>
<p>GitHub Actions workflows are configurations stored in YAML files. These files should be located in a <code>.github/workflows</code> folder in the package root. If all you want to do is render a <code>README.Rmd</code> to <code>README.md</code> you could just as easily create this folder yourself. I’m not sure why <strong>usethis</strong> creates a <code>.gitignore</code> containing <code>'*.html'</code> in the <code>.github</code> folder, but if this is needed for what you’re doing, go ahead an create it too.</p>
<p>To get set-up quickly to render <code>README.Rmd</code> to markdown, you can now use <code>use_github_action("render-readme.yaml")</code>. This will copy the <code>render-readme.yaml</code> file from <a href="https://github.com/r-lib/actions/tree/master/examples">r-lib/actions/examples</a> to <code>.github/workflows/render-readme.yaml</code>.</p>
<p>This is what the contents of this file looks like, at the time of writing:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb3-1" title="1"><span class="fu">on:</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="fu">push:</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="fu">paths:</span></a>
<a class="sourceLine" id="cb3-4" title="4">      <span class="kw">-</span> README.Rmd</a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="fu">name:</span><span class="at"> Render README</span></a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="fu">jobs:</span></a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="fu">render:</span></a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="fu">name:</span><span class="at"> Render README</span></a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="fu">runs-on:</span><span class="at"> macOS-latest</span></a>
<a class="sourceLine" id="cb3-12" title="12">    <span class="fu">steps:</span></a>
<a class="sourceLine" id="cb3-13" title="13">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> actions/checkout@v2</span></a>
<a class="sourceLine" id="cb3-14" title="14">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> r-lib/actions/setup-r@v1</span></a>
<a class="sourceLine" id="cb3-15" title="15">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> r-lib/actions/setup-pandoc@v1</span></a>
<a class="sourceLine" id="cb3-16" title="16">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Install rmarkdown</span></a>
<a class="sourceLine" id="cb3-17" title="17">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;install.packages(&quot;rmarkdown&quot;)&#39;</span></a>
<a class="sourceLine" id="cb3-18" title="18">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Render README</span></a>
<a class="sourceLine" id="cb3-19" title="19">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;rmarkdown::render(&quot;README.Rmd&quot;)&#39;</span></a>
<a class="sourceLine" id="cb3-20" title="20">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Commit results</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="fu">        run:</span> <span class="st">|</span></a>
<a class="sourceLine" id="cb3-22" title="22">          git commit README.md -m &#39;Re-build README.Rmd&#39; || echo &quot;No changes to commit&quot;</a>
<a class="sourceLine" id="cb3-23" title="23">          git push origin || echo &quot;No changes to commit&quot;</a></code></pre></div>
<p>The first bit under <code>on:</code> controls when the workflow is triggered. The way the example file is set up means the workflow will only be triggered <em>if</em> a file matching the path <code>README.Rmd</code> is included in the commit when pushed to the repo. It’s also worth noting that <em>until the workflow is actually triggered</em>, it won’t show up in the <em>Actions</em> tab in your repo on GitHub. To trigger this workflow, you need to edit <code>README.Rmd</code>, add and commit those changes using <code>git</code>, and then push the changes to GitHub.</p>
<p>That didn’t suit my use case however; what if I change the package code in such a way that any output or plots produced by R code in the <code>README.Rmd</code> would change? In this case, I would have to neddlessly tweak something in <code>README.Rmd</code> and push that change to trigger the rendering.</p>
<p>There’s probably a better way to do this — such as setting <code>paths:</code> to a wildcard that would match <em>any</em> <code>.R</code> file in the <code>R</code> folder so the workflow would be triggered on any change to the package code — but to just get something up and running I changed the <code>on:</code> part to read:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb4-1" title="1"><span class="fu">on:</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="fu">push:</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="fu">branches:</span><span class="at"> master</span></a></code></pre></div>
<p>which indicates the workflow will be triggered for any push to the <em>master</em> branch of the R package repo.</p>
<p>The top-level <code>name:</code> element is how your workflow will be listed in the Actions tab in your repo. Set this to something short but descriptive so it is easy to filter the various outputs from workflows that are run on the GitHub Actions service.</p>
<p>All workflows contain one or more <em>jobs</em>, listed under the <code>jobs:</code> element. In the example YAML file, there is a single job listed as <code>render:</code>, which has a name, <code>Render README</code>.</p>
<p>The <code>runs-on</code> element indicates what system the job will be run on; here is is a Mac OS system. I’m not sure why the <em>r-lib/actions</em> example workflows all run on Mac OS systems? Anyway, they work, so no need to change that unless you need something specific.</p>
<p>The <code>steps:</code> section is where the stages of the job are defined.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb5-1" title="1">    <span class="fu">steps:</span></a>
<a class="sourceLine" id="cb5-2" title="2">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> actions/checkout@v2</span></a>
<a class="sourceLine" id="cb5-3" title="3">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> r-lib/actions/setup-r@v1</span></a>
<a class="sourceLine" id="cb5-4" title="4">      <span class="kw">-</span> <span class="fu">uses:</span><span class="at"> r-lib/actions/setup-pandoc@v1</span></a></code></pre></div>
<p>Each of the <code>uses:</code> elements draws in some pre-existing worfklow steps that you can build to upon to bootstrap the solution you need. For example, the <code>actions/checkout@v2</code> workflow contains everything you need to checkout your repo and make it available to the current job. This is pretty fundamental as unless the GitHub Actions service can get at the code in your repo, it won’t be able to do anything useful.</p>
<p>The next two <code>uses:</code> are workflows provide by <em>r-lib/actions</em> that set up a working R installation (<code>r-lib/actions/setup-r@v1</code>) and the <strong>Pandoc</strong> library used by <strong>rmarkdown</strong> (<code>r-lib/actions/setup-pandoc@v1</code>).</p>
<p>After the <code>uses:</code> declarations, the YAML file includes a series of steps that describe commands that are run on the service. This is where the real action takes place.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb6-1" title="1">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Install rmarkdown</span></a>
<a class="sourceLine" id="cb6-2" title="2">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;install.packages(&quot;rmarkdown&quot;)&#39;</span></a>
<a class="sourceLine" id="cb6-3" title="3">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Render README</span></a>
<a class="sourceLine" id="cb6-4" title="4">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;rmarkdown::render(&quot;README.Rmd&quot;)&#39;</span></a>
<a class="sourceLine" id="cb6-5" title="5">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Commit results</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="fu">        run:</span> <span class="st">|</span></a>
<a class="sourceLine" id="cb6-7" title="7">          git commit README.md -m &#39;Re-build README.Rmd&#39; || echo &quot;No changes to commit&quot;</a>
<a class="sourceLine" id="cb6-8" title="8">          git push origin || echo &quot;No changes to commit&quot;</a></code></pre></div>
<p>Here we see three sets of commands that will be run</p>
<ol type="1">
<li>the first installs the <strong>rmarkdown</strong> package,</li>
<li>the second runs <code>rmarkdown::render()</code> on <code>README.Rmd</code> to render it, and</li>
<li>the third commits the rendered <code>README.md</code> file and pushes it to your repo, or echos a comment if no changes are needed.</li>
</ol>
<p>Notice how the <code>run:</code> element for the last set has a <code>|</code> after <code>run:</code>. This indicates that this particular step involves multiple lines of commands to be executed one after another.</p>
<p>If you’ve not come across <code>Rscript</code> before, it is a way to R like a scripting language, non-interactively. HEre we’re using the <code>-e</code> flag to tell Rscript what R code to run.</p>
<p>Out of the box, these steps aren’t going to be very useful for R package maintainers if the <code>README.Rmd</code> uses anything other than the base R installation and recommended packages. At the very least you are going to want to also install the R package you are documenting in the <code>README.Rmd</code>, plus any other packages you need for the <code>Rmd</code> that might not be dependencies of the package in the repo.</p>
<p>In my case, I just needed to install the <strong>gratia</strong> package alongside <strong>rmarkdown</strong>, so I changed the <code>run:</code> element to be</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb7-1" title="1">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Install rmarkdown</span></a>
<a class="sourceLine" id="cb7-2" title="2">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;install.packages(c(&quot;rmarkdown&quot;, &quot;gratia&quot;))&#39;</span></a></code></pre></div>
<p>I also decided to change the <code>rmarkdown::render()</code> call; by default this will generate HTML output by rendering the <code>.Rmd</code> first to <code>.md</code> and thence to <code>.html</code>. As we don’t need this latter step, I changed the <code>output_format</code> argument of <code>render()</code> to be <code>"md_document"</code>, so that element now looks like this</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb8-1" title="1">      <span class="kw">-</span> <span class="fu">name:</span><span class="at"> Render README</span></a>
<a class="sourceLine" id="cb8-2" title="2">        <span class="fu">run:</span><span class="at"> Rscript -e &#39;rmarkdown::render(&quot;README.Rmd&quot;, output_format = &quot;md_document&quot;)&#39;</span></a></code></pre></div>
<p>Doing this means I don’t also generate a <code>README.html</code> file (which might be why the <code>.gitignore</code> was created by <strong>usethis</strong> earlier); keeping the <code>.gitignore</code> can’t hurt given that it only excludes any <code>.html</code> files from a commit, so I left it alone.</p>
<p>I also modified the <em>commit</em> step too. The default assumes you already have a <code>README.md</code> in the repo and that this is the only file you want to add to the commit. If you render any plots in the <code>.Rmd</code>, then you’ll also want to add those to the commit. So I added an explicit <code>git add</code> line prior to the commit, and also simplified the latter</p>
<figure class="highlight">
<pre><code class="language-yaml" data-lang="yaml">      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Commit results</span>
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">git add README.md man/figures/README-*</span>
          <span class="s">git commit -m 'Re-build README.Rmd' || echo "No changes to commit"</span>
          <span class="s">git push origin || echo "No changes to commit"</span></code></pre>
</figure>
<p>As you can see, I used a wildcard to catch any figures created by the render. In the <code>README.Rmd</code> I used a setup chunk to set the <code>fig.path</code> <strong>knitr</strong> option so that any plots where generated in the <code>man/figures</code> folder and had the prefix <code>README-</code> prepended to the figure file name:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">fig.path =</span> <span class="st">&quot;man/figures/README-&quot;</span></a>
<a class="sourceLine" id="cb9-3" title="3">)</a></code></pre></div>
<p>The <code>man/figures</code> folder is a useful place to store figures generated like this as they’ll be carried along with your R package and available on CRAN, who also show the <code>README.md</code> file if present. This folder is also used if you generate and include figures in the package documentation using <strong>roxygen</strong>.</p>
<p>I used the prefix <code>README-</code> so that I could limit what I was adding in the <code>git add</code> step of the workflow. I’m always a bit nervous when staging files for a commit and never use <code>git commit -a</code> for example. This way I have a reasonable path to only add plots that were created by the render process.</p>

            <hr />
            <h3>Comments</h3>
            <div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = "fromthebottomoftheheap";
  var disqus_url = "https://www.fromthebottomoftheheap.net/2020-04-30-rendering-your-readme-with-github-actions/";
  var disqus_title = "Rendering your README with GitHub Actions";
  //var disqus_identifier = "";

  (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


            </div>
            <div class="span2">
                            <div class="side-snippet">
                <h4>By Gavin Simpson</h4>
              
                <h4>30 April 2020</h4>
              
              </div>

                            <div class="side-snippet">
                <h4>Posted in</h4>
                
              </div>
       

                            <div class="side-snippet">
                <h4>Tagged</h4>
                
                  <a href="https://www.fromthebottomoftheheap.net/tag/github/"><span class="label label-inverse">GitHub</span></a><br>
                
                  <a href="https://www.fromthebottomoftheheap.net/tag/github-actions/"><span class="label label-inverse">GitHub Actions</span></a><br>
                
                  <a href="https://www.fromthebottomoftheheap.net/tag/continuous-integration/"><span class="label label-inverse">Continuous Integration</span></a><br>
                
                  <a href="https://www.fromthebottomoftheheap.net/tag/r-package/"><span class="label label-inverse">R package</span></a><br>
                
                  <a href="https://www.fromthebottomoftheheap.net/tag/workflow/"><span class="label label-inverse">workflow</span></a><br>
                
              </div>

                          <div class="side-snippet">
              <h4>Social</h4>
              <p><img class="bs-icon addToolTip" data-original-title="Send me an email" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/glyphicons/glyphicons_419_e-mail.png" /> <a href="mailto:ucfagls@gmail.com">ucfagls@gmail.com</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="My twitter profile" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/glyphicons/glyphicons_411_twitter.png" /> <a href="https://twitter.com/ucfagls">@ucfagls</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="My github profile" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/glyphicons/glyphicons_401_github.png" /> <a href="https://github.com/gavinsimpson">gavinsimpson</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="ORCID ID" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/orcid_24x24.png" /> <a href="https://orcid.org/0000-0002-9084-8413">ORCID iD</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="Impactstory profile" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/impactstory-symbol.png" /> <a href="https://impactstory.org/u/0000-0002-9084-8413">Impactstory profile</a></p>
              <p><img class="bs-icon addToolTip" data-original-title="Subscribe to the blog via RSS (Atom)" data-placement="left" data-animation="true" src="https://www.fromthebottomoftheheap.net/assets/img/glyphicons/glyphicons_417_rss.png" /> <a href="https://www.fromthebottomoftheheap.net/feed.xml" type="application/atom+xml">Subscribe</a></p>
            </div>

                          <div class="side-snippet">
              <h4>Blogroll</h4>
              <ul class="unstyled">
                <li><i class="icon-bookmark"></i> <a href="http://downwithtime.wordpress.com/">Down With time</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://contemplativemammoth.wordpress.com/">The Contemplative Mammoth</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://dynamicecology.wordpress.com/">Dynamic Ecology</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://jabberwocky.weecology.org/">Jabberwocky Ecology</a></li>
                <li><i class="icon-bookmark"></i> <a href="https://recology.info/">Recology</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://www.r-bloggers.com/">R Bloggers</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://www.ancienteco.com/">Andrew Barr's Ancient Eco</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://methodsblog.wordpress.com/">Methods in Ecology &amp; Evolution</a></li>
                <li><i class="icon-bookmark"></i> <a href="http://quantpalaeo.wordpress.com/">Musings on Quantitative Palaeoecology</a></li>
              </ul>
            </div>

              
            </div>
          </div>
        </div>
      </div>
      </article>

        

    </div><!--/.fixed-container-->
    
    <footer>
      <div class="container">
        <div class="row">
          <div class="span2">
            <h4>Menu</h4>
            <ul class="unstyled">
              <li><a href="https://www.fromthebottomoftheheap.net"><small>Home</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/about/"><small>About</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/publications/"><small>Publications</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/research/"><small>Research</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/lab/"><small>The Lab</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/teaching/"><small>Teaching</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/dper-scripts/"><small>DPER Scripts</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/"><small>R Packages</small></a></li>
            </ul>
          </div>
          <div class="span2">
            <h4>R packages</h4>
            <ul class="unstyled">
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/analogue/"><small>analogue</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/permute/"><small>permute</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/vegan/"><small>vegan</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/gratia/"><small>gratia</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/cocorresp/"><small>cocorresp</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/coenocliner/"><small>coenocliner</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/temporalEF/"><small>temporalEF</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/canadaHCD/"><small>canadaHCD</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/ggvegan/"><small>ggvegan</small></a></li>
              <li><a href="https://www.fromthebottomoftheheap.net/code/r-packages/pcurve/"><small>pcurve</small></a></li>
            </ul>        
          </div>
          <div class="span6">
            <h4>Fineprint</h4>
            <p><small>Copyright &copy; 2010&ndash;2020 Gavin Simpson. <a href="https://www.fromthebottomoftheheap.net/permissions/">Some Rights Reserved</a>&nbsp;&nbsp;&nbsp;<a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://licensebuttons.net/l/by/4.0/80x15.png" /></a></small></p>
            <p><small>Icons by <a href="http://www.glyphicons.com/">Glyphicons</a> used under CC-BY licence</small></p>
          </div>
        </div>
      </div>
    </footer>
    
        <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://www.fromthebottomoftheheap.net/assets/js/jquery.min.js"></script>
    <script src="https://www.fromthebottomoftheheap.net/assets/js/bootstrap.js"></script>
    <!--<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script>
        jQuery(function ($) {
            $(".addToolTip").tooltip()
        });
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7900310-7"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-7900310-7');
</script>


    
    


  </body>
</html>


